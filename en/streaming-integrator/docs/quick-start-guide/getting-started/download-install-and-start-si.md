# Step 1: Download Streaming Integrator and Dependencies

First, you are required to download the Streaming Integrator and the other software needed for the scenario you are trying out. To do this, follow the topics below.

!!! tip "Before you begin:"
    - Install [Oracle Java SE Development Kit (JDK) version 1.8](https://www.oracle.com/technetwork/java/javase/downloads/index.html).<br/>
    - [Set the Java home](https://docs.oracle.com/cd/E19182-01/820-7851/inst_cli_jdk_javahome_t/) environment variable.<br/>
    
## Downloading the Streaming Integrator runtime and tooling

- To download the Streaming Integrator runtime, visit the [Streaming Integrator Product Page](https://wso2.com/integration/streaming-integrator/). Enter you email address and agree to the license. Then click **Zip Archive** download the Streaming Integrator as a zip file.

- To download Streaming Integrator Tooling, click **Tooling** in the [Streaming Integrator Product Page](https://wso2.com/integration/streaming-integrator/). Enter you email address and agree to the license. Then click **MacOS Installer pkg** download the Streaming Integrator as a zip file.

## Downloading the other dependencies for your scenario

This section shows how to prepare your production environment for the scenario described in the [Streaming Integration Overview section](download-install-and-start-si.md).

## Setting up a MySQL database table

In this scenario, the Streaming Integrator reads input data from a MySQL database table. Therefore, let's download and install MySQL and define the database and the database table as follows:

1. Download MySQL 5.1.49 from [MySQL Community Downloads](https://dev.mysql.com/downloads/connector/j/5.1.html).

2. Enable binary logging in the MySQL server. For detailed instructions, see [Enabling the Binlog tutorial by debezium](https://debezium.io/docs/connectors/mysql/#enabling-the-binlog).

3. Add the MySQL JDBC driver into the `<SI_HOME>/lib` directory as follows:

    1. Download the MySQL JDBC driver from [the MySQL site](https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-5.1.45.tar.gz).
    
    2. Unzip the archive.
    
    3. Copy the `mysql-connector-java-5.1.45-bin.jar` to the `<SI_HOME>/lib` directory.
    
    
4. Once you install MySQL and start the MySQL server, create the database and the database table you require as follows:

    1. Let's create a new database in the MySQL server which you are to use throughout this tutorial. To do this, execute the following query.
        ```
        CREATE SCHEMA production;
        ```
       
    2. Create a new user by executing the following SQL query.<br/>
        ```
        GRANT SELECT, RELOAD, SHOW DATABASES, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO 'wso2si' IDENTIFIED BY 'wso2';
        ```<br/>
    3. Switch to the `production` database and create a new table, by executing the following queries:<br/>
        `use production;`<br/>
        `CREATE TABLE SweetProductionTable (name VARCHAR(20),amount double(10,2));`<br/> 
               

## Download Kafka and create topics

This scenario involves publishing some filtered production data to a Kafka topic named `eclair_production`. 

1. Download the Kafka broker from [the Apache site](https://www.apache.org/dyn/closer.cgi?path=/kafka/2.3.0/kafka_2.12-2.3.0.tgz) and extract it.
   This directory is referred to as `<KAFKA_HOME>` from here on.
   
2. Start Kafka as follows:

    1. First, start a zoo keeper node. To do this, navigate to the `<KAFKA_HOME>` directory and issue the following command.
    
        `sh bin/zookeeper-server-start.sh config/zookeeper.properties`
    
    2. Next, start a Kafka server node. To do this, issue the following command from the same directory.
    
        `sh bin/kafka-server-start.sh config/server.properties`
        
    3. To create a Kafka topic named `eclair_production`, issue the following command from the same directory.
    
        `bin/kafka-topics.sh --create --bootstrap-server localhost:9092 --replication-factor 1 --partitions 1 --topic total_production`
        
## Configuring WSO2 SI to visualize statistics

To be able to see visualizations of statistics generated by WSO2 Streaming Integrator, follow the sections below:

## Downloading the required dashboards

WSO2 Streaming Integrator provides you with pre-configured dashboards in JSON format. You can import these dashboards bto Grafana to view statistics of your Streaming Integrator deployment.

For this scenario, download the following dashboards:

- [WSO2 Streaming Integrator - Overall Statistics.json](https://github.com/wso2/streaming-integrator/blob/master/modules/distribution/carbon-home/resources/dashboards/overview-statistics/WSO2%20Streaming%20Integrator%20-%20Overall%20Statistics.json)

- [WSO2 Streaming Integrator - App Statistics.json](https://github.com/wso2/streaming-integrator/blob/master/modules/distribution/carbon-home/resources/dashboards/overview-statistics/WSO2%20Streaming%20Integrator%20-%20App%20Statistics.json)

- [CDC Scheduled Statistics.json](https://github.com/wso2/streaming-integrator/blob/master/modules/distribution/carbon-home/resources/dashboards/cdc-statistics/WSO2%20Streaming%20Integrator%20-%20CDC%20Scheduled%20Statistics.json)

- [WSO2 Streaming Integrator - CDC Statistics.json](https://github.com/wso2/streaming-integrator/blob/master/modules/distribution/carbon-home/resources/dashboards/cdc-statistics/WSO2%20Streaming%20Integrator%20-%20CDC%20Statistics.json)

- [WSO2 Streaming Integrator - CDC Streaming Statistics.json](https://github.com/wso2/streaming-integrator/blob/master/modules/distribution/carbon-home/resources/dashboards/cdc-statistics/WSO2%20Streaming%20Integrator%20-%20CDC%20Streaming%20Statistics.json)

- [WSO2 Streaming Integrator - File Sink Statistics.json](https://github.com/wso2/streaming-integrator/blob/master/modules/distribution/carbon-home/resources/dashboards/file-statistics/WSO2%20Streaming%20Integrator%20-%20File%20Sink%20Statistics.json)

- [WSO2 Streaming Integrator - File Source Statistics.json](https://github.com/wso2/streaming-integrator/blob/master/modules/distribution/carbon-home/resources/dashboards/file-statistics/WSO2%20Streaming%20Integrator%20-%20File%20Source%20Statistics.json)

- [WSO2 Streaming Integrator - File Statistics.json](https://github.com/wso2/streaming-integrator/blob/master/modules/distribution/carbon-home/resources/dashboards/file-statistics/WSO2%20Streaming%20Integrator%20-%20File%20Statistics.json)

- [WSO2 Streaming Integration - RDBMS Statistics.json](https://github.com/wso2/streaming-integrator/blob/master/modules/distribution/carbon-home/resources/dashboards/rdbms-statistics/WSO2%20Streaming%20Integration%20-%20RDBMS%20Statistics.json)

- [WSO2 Streaming Integration - RDBMS Table Statistics.json](https://github.com/wso2/streaming-integrator/blob/master/modules/distribution/carbon-home/resources/dashboards/rdbms-statistics/WSO2%20Streaming%20Integration%20-%20RDBMS%20Table%20Statistics.json)


### Downloading and setting up Prometheus

WSO2 Streaming Integrator uses Perometheus to expose its statistics to Grafana. Therefore, to download and configure Prometheus, follow the steps below:

1. Download Prometheus from the [Prometheus site](https://prometheus.io/download/). For instructions, see [the Prometheus Getting Started Guide](https://prometheus.io/docs/prometheus/latest/getting_started/).

2. Extract the downloaded file. The directory that opens as a result is referred to as the `<PROMETHEUS_HOME>` from here on.

3. To enable statistics for the Prometheus reporter, open the `<SI_HOME>/conf/server/deployment.yaml` file and set the `enabled` parameter in the `wso2.metrics` section to `true`, and update the other parameters in the section as shown below. You also need to add the `metrics.prometheus:` as shown.

    ```
     wso2.metrics:
       # Enable Metrics
       enabled: true
       reporting:
         console:
           - # The name for the Console Reporter
             name: Console
    
             # Enable Console Reporter
             enabled: false
    
             # Polling Period in seconds.
             # This is the period for polling metrics from the metric registry and printing in the console
             pollingPeriod: 2
    
     metrics.prometheus:
      reporting:
        prometheus:
          - name: prometheus
            enabled: true
            serverURL: "http://localhost:9005"
    ```
   
4. Open the `<PROMETHEUS_HOME>/prometheus.yml` file and add the following configuration in the `scrape_configs:` section.

    ```
     scrape_configs:
       - job_name: 'prometheus'
         static_configs:
         - targets: ['localhost:9005']
    ```
   
5. In the terminal, navigate to the `<PROMETHEUS_HOME` and issue the following command to start the Prometheus server.

    `./prometheus`
    
!!! info
    The above steps to configure and start Prometheus need to be performed before you start the Grafana server.
    
### Downloading and setting up Grafana

The pre-configured dashboards provided by WSO2 Streaming Integrator which you previously downloaded are rendered in Grafana to visualize statistics. To download and set up Grafana, follow the steps below:

!!! tip "Before you begin:"
    Start the Prometheus server as instructed under [Downloading and setting up Prometheus](#downloading-and-setting-up-prometheus).

1. Download Grafana from the [Grafana Labs - Download Grafana](https://grafana.com/grafana/download).

2. Start Grafana.

    !!! info
        The procedure to start Grafana depends on your operating system and the installation process. e.g., If your operating system is Mac OS and you have installed Grafana via Homebrew, you start Grafana by issuing the `brew services start grafana` command.
        
3. In the **Data Sources** section, click **Add your first data source**. In the **Add data source** page that appears, click **Select** for **Prometheus**.
       
4. In the **Add data source** page -> **Settings** tab, update the configurations for Prometheus as follows.<br/>   
   ![prometheus configuration](../../images/cdc-monitoring/prometheus-configurations.png)<br/>    
   1. Click **Default** to make Prometheus the default data source.
   
   2. Under **HTTP**, enter `http://localhost:9090` as the URL.
   
   3. Click **Save & Test**. If the data source is successfully configured, it is indicated via a message.
       ![Save and Test](../../images/cdc-monitoring/save-and-test.png)
       
   4. To import the dashboards that you previously downloaded as JSON files, follow the procedure below:
   
        1. Start Grafana and access it via http://localhost:3000/.
        
        2. To load a new dashboard, click the plus icon **(+)** in the side panel. Then click **Import**.
        
        3. In the **Import** page, click **Upload .json** file. Then browse and select the .json file of the preconfigured dashboard that you downloaded (i.e., in step 5, substep 1).
        
        4. If required, change the unique identifier displayed in the **Unique Identifier (uid)**.
        
        5. Click **Import**.
        
## Starting the WSO2 Streaming Integrator Server

To start WSO2 Streaming Integrator, navigate to the `<SI_HOME>/bin` directory from the CLI, and issue the appropriate command based on your operating system:

- **For Linux**: `./server.sh`
- **For Windows**: `server.bat --run`           
              
Now you have completed a WSO2 Streaming Integrator setup that is capable of the following:

- Design, test and deploy Siddhi applications via Streaming Integrator Tooling.

- Consume data from as well as publish data to MySQL databases.

- Consume data from as well as publish data to Kafka topics.

- Detect events with errors and to manage those errors.

- Visualize statistics in dashboards.

